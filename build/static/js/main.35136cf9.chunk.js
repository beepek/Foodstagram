(this["webpackJsonpjwt-boilerplate"]=this["webpackJsonpjwt-boilerplate"]||[]).push([[0],{152:function(e,t,n){},153:function(e,t,n){},161:function(e,t,n){},162:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(56),s=n.n(a),c=(n(151),n(152),n(9)),o=n(8),i=(n(153),n(10)),l=n(14),j=n(15),u=n(79),h=n(1);function d(e){return Object(h.jsx)("span",{className:"error",children:e.error})}var b=n(182),O=n(183),p=n(134),g=n(175),x=n(184),m=n(180);function f(){var e=localStorage.getItem("token");e&&(JSON.parse(atob(e.split(".")[1])).exp<Date.now()/1e3&&(localStorage.removeItem("token"),e=null));return e}var v={setToken:function(e){e?localStorage.setItem("token",e):localStorage.removeItem("token")},getToken:f,removeToken:function(){localStorage.removeItem("token")},getUserFromToken:function(){var e=f();return e?JSON.parse(atob(e.split(".")[1])).user:null}},w="/api/users/";var y={signup:function(e){return fetch(w+"signup",{method:"POST",body:e}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw console.log(e),new Error(e.err)}))})).then((function(e){var t=e.token;return v.setToken(t)}))},getUser:function(){return v.getUserFromToken()},logout:function(){v.removeToken()},login:function(e){return fetch(w+"login",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw console.log(e),new Error(e.err)}))})).then((function(e){var t=e.token;return v.setToken(t)}))},getProfile:function(e){return console.log("getProfile calling"),fetch(w+e,{headers:{Authorization:"Bearer "+v.getToken()}}).then((function(e){if(e.ok)return e.json();throw new Error("Error from getProfile Request, check the server terminal!")}))}};function k(e,t){return e===t}function C(e){var t=Object(r.useState)({message:"",passwordError:!1}),n=Object(c.a)(t,2),a=n[0],s=n[1],f=Object(r.useState)({username:"",email:"",password:"",passwordConf:"",bio:""}),v=Object(c.a)(f,2),w=v[0],C=v[1],S=Object(r.useState)(""),A=Object(c.a)(S,2),U=A[0],T=A[1],P=Object(o.m)();function L(e){C(Object(u.a)(Object(u.a)({},w),{},Object(j.a)({},e.target.name,e.target.value)))}function E(){return(E=Object(l.a)(Object(i.a)().mark((function t(n){var r,a;return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),k(w.password,w.passwordConf)){t.next=3;break}return t.abrupt("return",s({message:"Passwords Must Match!",passwordError:!0}));case 3:for(a in s({message:"",passwordError:!1}),(r=new FormData).append("photo",U),w)r.append(a,w[a]);return console.log(r," <- form Data, you cant see this!","you have to loop over it"),console.log(r.forEach((function(e){return console.log(e)}))," < This lets you see the key values in formData"),t.prev=9,t.next=12,y.signup(r);case 12:e.handleSignUpOrLogin(),P("/"),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(9),console.log(t.t0),s({message:t.t0.message,passwordError:!1});case 20:case"end":return t.stop()}}),t,null,[[9,16]])})))).apply(this,arguments)}return Object(h.jsx)(b.a,{textAlign:"center",style:{height:"100vh",width:"100vw"},verticalAlign:"middle",children:Object(h.jsxs)(b.a.Column,{style:{maxWidth:450},children:[Object(h.jsxs)(O.a,{as:"h2",color:"teal",textAlign:"center",children:[Object(h.jsx)(p.a,{src:"https://i.imgur.com/CRCb47X.png"})," Sign Up"]}),Object(h.jsxs)(g.a,{onSubmit:function(e){return E.apply(this,arguments)},children:[Object(h.jsxs)(x.a,{stacked:!0,children:[Object(h.jsx)(g.a.Input,{name:"username",placeholder:"username",value:w.username,onChange:L,required:!0}),Object(h.jsx)(g.a.Input,{type:"email",name:"email",placeholder:"email",value:w.email,onChange:L,required:!0}),Object(h.jsx)(g.a.Input,{error:a.passwordError,name:"password",type:"password",placeholder:"password",value:w.password,onChange:L,required:!0}),Object(h.jsx)(g.a.Input,{error:a.passwordError,name:"passwordConf",type:"password",placeholder:"Confirm Password",value:w.passwordConf,onChange:L,required:!0}),Object(h.jsx)(g.a.TextArea,{label:"bio",name:"bio",placeholder:"Tell us about yourself, Chef!",value:w.bio,onChange:L}),Object(h.jsx)(g.a.Field,{children:Object(h.jsx)(g.a.Input,{type:"file",name:"photo",placeholder:"upload image",onChange:function(e){console.log(e.target.files," < - this is e.target.files!"),T(e.target.files[0])}})}),Object(h.jsx)(m.a,{type:"submit",className:"btn",children:"Signup"})]}),a.message?Object(h.jsx)(d,{error:a.message}):null]})]})})}n(161);var S=n(29),A=n(179);function U(e){var t=Object(r.useState)(""),n=Object(c.a)(t,2),a=n[0],s=n[1],f=Object(r.useState)({email:"",password:""}),v=Object(c.a)(f,2),w=v[0],k=v[1],C=Object(o.m)();function U(e){k(Object(u.a)(Object(u.a)({},w),{},Object(j.a)({},e.target.name,e.target.value)))}function T(){return(T=Object(l.a)(Object(i.a)().mark((function t(n){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,y.login(w);case 4:e.handleSignUpOrLogin(),C("/"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),s(t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return Object(h.jsx)(b.a,{textAlign:"center",style:{height:"100vh",width:"100vw"},verticalAlign:"middle",children:Object(h.jsxs)(b.a.Column,{style:{maxWidth:450},children:[Object(h.jsxs)(O.a,{as:"h2",color:"teal",textAlign:"center",children:[Object(h.jsx)(p.a,{src:"https://i.imgur.com/CRCb47X.png"})," Log-in to your account"]}),Object(h.jsx)(g.a,{onSubmit:function(e){return T.apply(this,arguments)},children:Object(h.jsxs)(x.a,{stacked:!0,children:[Object(h.jsx)(g.a.Input,{type:"email",name:"email",placeholder:"email",value:w.email,onChange:U,required:!0}),Object(h.jsx)(g.a.Input,{name:"password",type:"password",placeholder:"password",value:w.password,onChange:U,required:!0}),Object(h.jsx)(m.a,{color:"teal",fluid:!0,size:"large",type:"submit",className:"btn",children:"Login"})]})}),Object(h.jsxs)(A.a,{children:["New to us? ",Object(h.jsx)(S.b,{to:"/signup",children:"Sign Up"})]}),a?Object(h.jsx)(d,{error:a}):null]})})}var T=function(e){var t=e.user;return Object(h.jsx)(b.a,{textAlign:"center",columns:2,children:Object(h.jsxs)(b.a.Row,{children:[Object(h.jsx)(b.a.Column,{children:Object(h.jsx)(p.a,{src:"".concat(t.photoUrl?t.photoUrl:"https://react.semantic-ui.com/images/wireframe/square-image.png"," "),avatar:!0,size:"small"})}),Object(h.jsxs)(b.a.Column,{textAlign:"left",style:{maxWidth:450},children:[Object(h.jsx)(x.a,{vertical:!0,children:Object(h.jsx)("h3",{children:t.username})}),Object(h.jsx)(x.a,{children:Object(h.jsxs)("span",{children:[" Bio: ",t.bio]})})]})]})})},P=n(177),L=n(178),E=n(83),R=n(176),I=function(){return Object(h.jsxs)(R.a.Group,{children:[Object(h.jsx)(O.a,{as:"h3",dividing:!0,children:"Comments"}),Object(h.jsxs)(R.a,{children:[Object(h.jsx)(R.a.Avatar,{src:"https://react.semantic-ui.com/images/avatar/small/matt.jpg"}),Object(h.jsxs)(R.a.Content,{children:[Object(h.jsx)(R.a.Author,{as:"a",children:"Matt"}),Object(h.jsx)(R.a.Metadata,{children:Object(h.jsx)("div",{children:"Today at 5:42PM"})}),Object(h.jsx)(R.a.Text,{children:"Looks Delicious!"}),Object(h.jsx)(R.a.Actions,{children:Object(h.jsx)(R.a.Action,{children:"Reply"})})]})]}),Object(h.jsxs)(R.a,{children:[Object(h.jsx)(R.a.Avatar,{src:"https://react.semantic-ui.com/images/avatar/small/elliot.jpg"}),Object(h.jsxs)(R.a.Content,{children:[Object(h.jsx)(R.a.Author,{as:"a",children:"Elliot Fu"}),Object(h.jsx)(R.a.Metadata,{children:Object(h.jsx)("div",{children:"Yesterday at 12:30AM"})}),Object(h.jsx)(R.a.Text,{children:Object(h.jsx)("p",{children:"Cant recommend this burger enough!"})}),Object(h.jsx)(R.a.Actions,{children:Object(h.jsx)(R.a.Action,{children:"Reply"})})]}),Object(h.jsx)(R.a.Group,{children:Object(h.jsxs)(R.a,{children:[Object(h.jsx)(R.a.Avatar,{src:"https://react.semantic-ui.com/images/avatar/small/jenny.jpg"}),Object(h.jsxs)(R.a.Content,{children:[Object(h.jsx)(R.a.Author,{as:"a",children:"Jenny Hess"}),Object(h.jsx)(R.a.Metadata,{children:Object(h.jsx)("div",{children:"Just now"})}),Object(h.jsx)(R.a.Text,{children:"Elliot you are always so right :)"}),Object(h.jsx)(R.a.Actions,{children:Object(h.jsx)(R.a.Action,{children:"Reply"})})]})]})})]}),Object(h.jsxs)(R.a,{children:[Object(h.jsx)(R.a.Avatar,{src:"https://react.semantic-ui.com/images/avatar/small/joe.jpg"}),Object(h.jsxs)(R.a.Content,{children:[Object(h.jsx)(R.a.Author,{as:"a",children:"Joe Henderson"}),Object(h.jsx)(R.a.Metadata,{children:Object(h.jsx)("div",{children:"5 days ago"})}),Object(h.jsx)(R.a.Text,{children:"Dude, this is awesome. Thanks so much"}),Object(h.jsx)(R.a.Actions,{children:Object(h.jsx)(R.a.Action,{children:"Reply"})})]})]}),Object(h.jsxs)(g.a,{reply:!0,children:[Object(h.jsx)(g.a.TextArea,{}),Object(h.jsx)(m.a,{content:"Add Reply",labelPosition:"left",icon:"edit",primary:!0})]})]})},F="/api/posts";function q(e){return fetch(F,{method:"POST",body:e,headers:{Authorization:"Bearer "+v.getToken()}}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw console.log(e),new Error(e.err)}))}))}function D(){return fetch(F,{headers:{Authorization:"Bearer "+v.getToken()}}).then((function(e){return console.log("this is the res.json",e),e.ok?e.json():e.json().then((function(e){throw console.log(e),new Error(e.err)}))}))}var z=function(e){var t=e.post,n=e.isProfile;return e.addComment,e.removeComment,e.loggedUser,console.log(t,"heres the posts"),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(P.a,{raised:!0,children:[n?"":Object(h.jsx)(P.a.Content,{textAlign:"left",children:Object(h.jsx)(P.a.Header,{children:Object(h.jsxs)(S.b,{to:"/".concat(t.user.username),children:[Object(h.jsx)(p.a,{size:"large",avatar:!0,src:t.user.photoUrl?t.user.photoUrl:"https://react.semantic-ui.com/images/wireframe/square-image.png"}),t.user.username]})})}),Object(h.jsx)(p.a,{src:"".concat(null===t||void 0===t?void 0:t.photoUrl),wrapped:!0,ui:!1}),Object(h.jsxs)(P.a.Content,{children:[Object(h.jsx)(P.a.Description,{children:t.caption}),Object(h.jsx)(E.a,{name:"delete",size:"large",color:"red",onClick:function(){var e;e=t._id,fetch("/api/posts/"+e,{headers:{Authorization:"Bearer "+v.getToken()}}).then((function(e){return console.log("this is the res.json",e),e.ok?e.json():e.json().then((function(e){throw console.log(e),new Error(e.err)}))}))}})]})]},t._id),Object(h.jsx)(I,{})]})},M=n(174);function N(){return Object(h.jsx)(M.a,{size:"small",active:!0,children:"Loading"})}function J(e){var t=e.posts,n=e.numPhotosCol,r=e.isProfile,a=e.loading,s=e.loggedUser;return Object(h.jsxs)(P.a.Group,{itemsPerRow:n,stackable:!0,children:[a?Object(h.jsxs)(x.a,{children:[Object(h.jsx)(L.a,{active:!0,inverted:!0,children:Object(h.jsx)(N,{size:"small",children:"Loading.."})}),Object(h.jsx)(p.a,{src:"https://react.semantic-ui.com/images/wireframe/short-paragraph.png"})]}):null,t.map((function(e){return Object(h.jsx)(z,{post:e,isProfile:r,loggedUser:s},e._id)}))]})}function W(e){var t=e.loggedUser,n=e.handleLogout;return Object(h.jsxs)(x.a,{clearing:!0,children:[Object(h.jsxs)(O.a,{as:"h2",floated:"right",children:[Object(h.jsx)(S.b,{to:"/",children:Object(h.jsx)(E.a,{name:"home"})}),Object(h.jsx)(S.b,{to:"",onClick:n,children:"Logout"})]}),Object(h.jsx)(O.a,{as:"h2",floated:"left",children:Object(h.jsx)(S.b,{to:"/".concat(null===t||void 0===t?void 0:t.username),children:Object(h.jsx)(p.a,{src:null!==t&&void 0!==t&&t.photoUrl?null===t||void 0===t?void 0:t.photoUrl:"https://react.semantic-ui.com/images/wireframe/square-image.png",avatar:!0})})})]})}function B(e){var t=e.loggedUser,n=e.handleLogout,a=Object(r.useState)([]),s=Object(c.a)(a,2),j=s[0],u=s[1],O=Object(r.useState)({}),p=Object(c.a)(O,2),g=p[0],x=p[1],m=Object(r.useState)(!0),f=Object(c.a)(m,2),v=f[0],w=f[1],k=Object(r.useState)(""),C=Object(c.a)(k,2),S=C[0],A=C[1],U=Object(o.o)().username,P=Object(r.useCallback)(Object(l.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(U,"this is the username"),e.next=4,y.getProfile(U);case 4:t=e.sent,w(!1),x(t.data.user),u(t.data.posts),console.log(t),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.message),A("Profile does not exist");case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),[U]);return Object(r.useEffect)((function(){console.log("its firing"),P()}),[U,P]),S?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(W,{handleLogout:n,loggedUser:t}),Object(h.jsx)(d,{error:S})]}):v?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(W,{handleLogout:n,loggedUser:t}),Object(h.jsx)(N,{})]}):Object(h.jsxs)(b.a,{children:[Object(h.jsx)(b.a.Row,{children:Object(h.jsx)(b.a.Column,{children:Object(h.jsx)(W,{handleLogout:n,loggedUser:t})})}),Object(h.jsx)(b.a.Row,{children:Object(h.jsx)(b.a.Column,{children:Object(h.jsx)(T,{user:g})})}),Object(h.jsx)(b.a.Row,{centered:!0,children:Object(h.jsx)(b.a.Column,{style:{maxWidth:750},children:Object(h.jsx)(J,{posts:j,numPhotosCol:3,isProfile:!0,loading:v,loggedUser:t})})})]})}var H=n(28);function G(e){var t=Object(r.useState)({caption:""}),n=Object(c.a)(t,2),a=n[0],s=n[1],o=Object(r.useState)(""),i=Object(c.a)(o,2),l=i[0],j=i[1];return Object(h.jsx)(x.a,{children:Object(h.jsxs)(g.a,{onSubmit:function(t){t.preventDefault();var n=new FormData;n.append("photo",l),n.append("caption",a.caption),e.handleAddPost(n)},children:[Object(h.jsx)(g.a.Input,{className:"form-control",name:"caption",value:a.caption,placeholder:"Tell us about your recipie!",onChange:function(e){s({caption:e.target.value})},required:!0}),Object(h.jsx)(g.a.Field,{children:Object(h.jsx)(g.a.Input,{type:"file",name:"photo",placeholder:"upload image",onChange:function(e){j(e.target.files[0])}})}),Object(h.jsx)(m.a,{type:"submit",className:"btn",children:"Add A Recipie or Meal!"})]})})}function _(e){var t=e.loggedUser,n=e.handleLogout,a=Object(r.useState)([]),s=Object(c.a)(a,2),o=s[0],j=s[1],u=Object(r.useState)(!0),O=Object(c.a)(u,2),p=O[0],g=O[1],x=Object(r.useState)(""),m=Object(c.a)(x,2),f=m[0],v=m[1];function w(){return(w=Object(l.a)(Object(i.a)().mark((function e(t){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(!0),e.next=4,q(t);case 4:n=e.sent,console.log(n),j([n.data].concat(Object(H.a)(o))),g(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message),v("Error creating post, please try again");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function y(){return(y=Object(l.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D();case 3:t=e.sent,console.log(t," data"),j(Object(H.a)(t.data)),g(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0.message," this is the getPosts error"),g(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){!function(){y.apply(this,arguments)}()}),[]),f?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(W,{handleLogout:n,loggedUser:t}),Object(h.jsx)(d,{error:f}),";"]}):p?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(W,{handleLogout:n,loggedUser:t}),Object(h.jsx)(N,{})]}):Object(h.jsxs)(b.a,{centered:!0,children:[Object(h.jsx)(b.a.Row,{children:Object(h.jsx)(b.a.Column,{children:Object(h.jsx)(W,{handleLogout:n,loggedUser:t})})}),Object(h.jsx)(b.a.Row,{children:Object(h.jsx)(b.a.Column,{style:{maxWidth:450},children:Object(h.jsx)(G,{handleAddPost:function(e){return w.apply(this,arguments)}})})}),Object(h.jsx)(b.a.Row,{children:Object(h.jsx)(b.a.Column,{style:{maxWidth:450},children:Object(h.jsx)(J,{posts:o,numPhotosCol:1,isProfile:!1,loggedUser:t})})})]})}var X=function(){var e=Object(r.useState)(y.getUser()),t=Object(c.a)(e,2),n=t[0],a=t[1];function s(){a(y.getUser())}function i(){y.logout(),a(null)}return console.log(n,"this is user"),n?Object(h.jsxs)(o.d,{children:[Object(h.jsx)(o.b,{path:"/",element:Object(h.jsx)(_,{loggedUser:n,handleLogout:i})}),Object(h.jsx)(o.b,{path:"/login",element:Object(h.jsx)(U,{handleSignUpOrLogin:s})}),Object(h.jsx)(o.b,{path:"/signup",element:Object(h.jsx)(C,{handleSignUpOrLogin:s})}),Object(h.jsx)(o.b,{path:"/:username",element:Object(h.jsx)(B,{loggedUser:n,handleLogout:i})})]}):Object(h.jsxs)(o.d,{children:[Object(h.jsx)(o.b,{path:"/login",element:Object(h.jsx)(U,{handleSignUpOrLogin:s})}),Object(h.jsx)(o.b,{path:"/signup",element:Object(h.jsx)(C,{handleSignUpOrLogin:s})}),Object(h.jsx)(o.b,{path:"/*",element:Object(h.jsx)(o.a,{to:"/login"})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(h.jsx)(S.a,{children:Object(h.jsx)(X,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[162,1,2]]]);
//# sourceMappingURL=main.35136cf9.chunk.js.map